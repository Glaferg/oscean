<!DOCTYPE html><html lang='en'><head><meta charset='utf-8'><meta name='description' content='Uxn is a 8-bit virtual stack machine.'/><meta name='thumbnail' content='https://wiki.xxiivv.com/media/services/thumbnail.jpg' /><meta name='viewport' content='width=device-width,initial-scale=1'><link rel='alternate' type='application/rss+xml' title='RSS Feed' href='../links/rss.xml' /><link rel='stylesheet' type='text/css' href='../links/main.css'><link rel='shortcut icon' type='image/png' href='../media/services/icon.png'><title>XXIIVV &mdash; uxn</title></head><body><header><a href='home.html'><img src='../media/icon/logo.svg' alt='XXIIVV' height='29'></a></header><nav><ul><li><a href='paper_computing.html'>paper computing</a></li><li><a href='programming.html'>programming</a></li><li><a href='virtual_machines.html'>virtual machines/</a></li><li><a href='fluidics.html'>fluidics</a></li></ul><ul><li><a href='orca.html'>orca</a></li><li><a href='gyo.html'>gyo</a></li><li><a href='uxn.html'>uxn/</a></li><li><a href='noton.html'>noton</a></li><li><a href='paradise.html'>paradise</a></li></ul><ul><li><a href='uxambly.html'>uxambly</a></li><li><a href='uxnemu.html'>uxnemu</a></li><li><a href='goki.html'>goki</a></li></ul></nav><main><figure><img src='../media/diary/739.jpg' alt='Uxn Sticker picture' width='900'/><figcaption>15C06 &mdash; Uxn Sticker</figcaption></figure><h2>Uxn is a 8-bit virtual stack machine.</h2><p>Uxn is a portable 8-bit virtual computer inspired by <a href='forth.html'>forth-machines</a>, capable of running simple <a href='tools.html'>tools</a> and <a href='games.html'>games</a> written in its <a href='uxambly.html'>esoteric assembly language</a>. The distribution of Uxn projects is not unlike downloading a rom for a console emulator.</p><img src='../media/generic/uxn.png' width='200' style='float:right'/><p>The thin layer that is the <a href='uxnemu.html'>Uxn emulator</a> is be the only part of this project needing to be ported to make the device available on a new platform. For that reason, Uxn was designed with a focus on portability such that it welcomes anyone to try their hand at building their own implementation. The <a href='https://git.sr.ht/~rabbits/uxn' target='_blank'>current emulator</a> is 400 lines of C89, with SDL2 as its only dependecy.</p><p>While the aim is to distribute assembled binaries, to respect the <a href='about.html'>philosophy</a> of the tool's ecosystem, the assembly, assembler and emulator sources are packaged alongside the roms. Similarly to the emulator, the assembler is extremely simple in its implementation as to not discourage re-implementations. The assembler is 400 lines of C89 with no dependencies.</p><figure><h2>Memory</h2>

<table border='1'>
	<tr><th rowspan='4'>Core</th><td>Program Counter</td><td>1 short</td></tr>
	<tr><td>Literal Counter</td><td>1 byte</td></tr>
	<tr><td>Balance Counter</td><td>1 byte</td></tr>
	<tr><td>Status Register</td><td>1 byte</td></tr>
	<tr><th rowspan='2'>Stacks</th><td>Working Stack</td><td>256 bytes</td></tr>
	<tr><td>Return Stack</td><td>256 bytes</td></tr>
	<tr><th>Memory</th><td>RAM</td><td>65536 bytes</td></tr>
</table>

<h3>Status Register</h3>

<p>The status register is distributed as follows, it shares the same byte as the register selector. The <b>halt</b> flag is used by the BRK instruction is stops the cpu, the <b>short</b> flag is used for 16-bits operations, the <b>cond</b> flag is set when an instruction requires a non-zero stack value to operate, and the <b>sign</b> flag is set when the operator should use signed integers.</p>

<pre>
T C S H
| | | +---- Halt  0x01
| | +------ Short 0x02
| +-------- Sign  0x04
+---------- Cond  0x08
</pre>

<h3>Return Stack</h3>

<p>The CPU can tunnel through 128 subroutines and find its way back with the return stack, the opcode to jump into to a subroutine is <code>JSR</code>, the opcode to return from a subroutine is <code>RTS</code>. An item on the work stack can be temporarily sent to the return stack with <code>WSR</code> and returned with <code>RSW</code>.</p>

<h2>Opcodes</h2>

<p>There are 32 opcodes, each opcode occupies 5 bits of a byte, the remaining 3 are used to select the addressing mode of the values in the stack.</p>

<table border='1'>
	<tr><td colspan='3'>mode</td><td colspan='5'>opcode</td></tr>
	<tr><td>cond</td><td>sign</td><td>short</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
</table>

<p>Opcodes pointing to an address in memory can pull 16-bits(2 bytes) from the stack at a time to form an address like <code>[a b]</code>, where the a and b bytes are combined. For example, <code>[0xAB 0xCD]</code> points to the memory address <code>0xABCD</code>. When used a single byte, these operators point to a relative address.</p>

<table border='1'>
	<tr><td></td><th colspan='3'>I/O</th><td></td>                      <th colspan='3'>Stack</th></tr>
	<tr><th>0x00</th><td><code>BRK</code></td><td></td><td></td>        <th>0x10</th><td><code>POP</code></td><td>a</td><td></td></tr>
	<tr><th>0x01</th><td><code>NOP</code></td><td></td><td></td>        <th>0x11</th><td><code>DUP</code></td><td>a</td><td>a a</td></tr>
	<tr><th>0x02</th><td><code>LIT</code></td><td></td><td>lc</td>      <th>0x12</th><td><code>SWP</code></td><td>a b</td><td>b a</td></tr>
	<tr><th>0x03</th><td><code>JMP</code></td><td>[a b]</td><td></td>   <th>0x13</th><td><code>OVR</code></td><td>a b c</td><td>a b a</td></tr>
	<tr><th>0x04</th><td><code>JSR</code></td><td>[a b]</td><td>rs</td> <th>0x14</th><td><code>ROT</code></td><td>a b c</td><td>b c a</td></tr>
	<tr><th>0x05</th><td><code>RTS</code></td><td></td><td>rs</td>      <th>0x15</th><td><code>---</code></td><td></td><td></td></tr>
	<tr><th>0x06</th><td><code>LDR</code></td><td>[a b]</td><td>c</td>  <th>0x16</th><td><code>WSR</code></td><td>a</td><td>rs</td></tr>
	<tr><th>0x07</th><td><code>STR</code></td><td>a [b c]</td><td></td> <th>0x17</th><td><code>RSW</code></td><td>rs</td><td>a</td></tr>
	<tr><td></td><th colspan='3'>Logic</th><td></td>                    <th colspan='3'>Arithmetic</th></tr>
	<tr><th>0x08</th><td><code>---</code></td><td></td><td></td>        <th>0x18</th><td><code>ADD</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x09</th><td><code>---</code></td><td></td><td></td>        <th>0x19</th><td><code>SUB</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0a</th><td><code>---</code></td><td></td><td></td>        <th>0x1a</th><td><code>MUL</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0b</th><td><code>---</code></td><td></td><td></td>        <th>0x1b</th><td><code>DIV</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0c</th><td><code>AND</code></td><td>a b</td><td>c</td>    <th>0x1c</th><td><code>EQU</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0d</th><td><code>XOR</code></td><td>a b</td><td>c</td>    <th>0x1d</th><td><code>NEQ</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0e</th><td><code>ROL</code></td><td>a b</td><td>c</td>    <th>0x1e</th><td><code>LTH</code></td><td>a b</td><td>c</td></tr>
	<tr><th>0x0f</th><td><code>ROR</code></td><td>a b</td><td>c</td>    <th>0x1f</th><td><code>GTH</code></td><td>a b</td><td>c</td></tr>
</table>

<p><code>lc</code> stands for <i>literal counter</i>, <code>rs</code> for <i>return stack</i>, <code>mp</code> stands for <i>memory pointer</i>.</p>

<style>
.clr0 { background:white; color:black; }
.clr1 { background:black; color:white; }
.clr2 { background:#72dec2; color:white; }
.clr3 { background:#ff0000; color:black; }
</style>

<img src='../media/identity/uxn64.png' />
<figcaption>&mdash; Submit an <a href='https://github.com/XXIIVV/oscean/blob/master/src/inc/html/uxn.htm' target='_blank'>edit</a> to <a href='../src/inc/html/uxn.htm'>uxn.htm</a>(70 lines)</figcaption>
</figure><figure><img src='../media/diary/744.jpg' alt='Uxambly is a programming language for the Uxn stack-machine. picture' width='900'/><figcaption><a href='uxambly.html'>uxambly</a> &mdash; Uxambly is a programming language for the Uxn stack-machine.</figcaption></figure><h2><a href='uxambly.html'>uxambly</a></h2><h4>Uxambly is a programming language for the Uxn stack-machine.</h4><img src='../media/generic/uxn.beet.png' width='150' style='float:right'/><p>The <a href='uxn.html'>Uxn</a> cpu understands 8-bit machine code, and that code corresponds to operations and values used in programs. The programming language that turns source code into Uxn roms, is called <b>Uxambly</b>, it's a unique flavor of assembly designed for this special stack-machine.</p><p>Stack machine programming might look at bit odd, as it uses a <a href='reverse_polish.html'>postfix notation</a>, which means that operators are always found at the end of an operation. For instance, one would write <code>3 4 +</code> instead of <code>3 + 4</code>. The expression written <code>(5 + 10) * 3</code> in conventional notation would be written <code>3 10 5 + *</code> in reverse Polish notation.</p><h2><a href='uxnemu.html'>uxnemu</a></h2><h4>Uxnemu is a SDL emulator maintained by Hundred Rabbits.</h4><p>Devices are external systems to the Uxn code such as the screen, the mouse, the keyboard, etc. There is a maximum of 16 devices accessible via the last page in memory, each device have 8 bytes to read from, and 8 bytes to write to. </p><figure><img src='../media/diary/742.jpg' alt='An operating system running on UxnVM. picture' width='900'/><figcaption><a href='goki.html'>goki</a> &mdash; An operating system running on UxnVM.</figcaption></figure><h2><a href='goki.html'>goki</a></h2><h4>An operating system running on UxnVM.</h4><p>More details shortly, see <a href='uxn.html'>Uxn</a>.</p><img src='../media/identity/uxn64.png'/>&nbsp;<ul><li><a href='https://git.sr.ht/~rabbits/uxn' target='_blank'>sources</a></li><li><a href='https://fabiensanglard.net/another_world_polygons' target='_blank'>polygons of another world</a></li></ul><p><i>incoming(7)</i>: <a href='tools.html'>tools</a> <a href='nasu.html'>nasu</a> <a href='gyo.html'>gyo</a> <a href='uxambly.html'>uxambly</a> <a href='goki.html'>goki</a> <a href='ayatori.html'>ayatori</a> <a href='forth.html'>forth</a> </p><p><i>Last update on <a href='tracker.html'>15E04</a>, edited 13 times. +51/80fh <b></b></i> <code style='float:right; font-size:80%'>-----|</code></p></main><footer><a href='https://creativecommons.org/licenses/by-nc-sa/4.0'><img src='../media/icon/cc.svg' width='30'/></a><a href='http://webring.xxiivv.com/'><img src='../media/icon/rotonde.svg' width='30'/></a><a href='https://merveilles.town/@neauoire'><img src='../media/icon/merveilles.svg' width='30'/></a><a href='https://github.com/neauoire'><img src='../media/icon/github.png' alt='github' width='30'/></a><span><a href='devine_lu_linvega.html'>Devine Lu Linvega</a> &copy; 2021 &mdash; <a href='about.html'>BY-NC-SA 4.0</a></span></footer></body></html>